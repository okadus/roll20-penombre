/* === @Fontface === */
@import url("https://fonts.googleapis.com/css2?family=Fasthand&family=Pirata+One&display=swap");

@font-face {
  font-family: "Freely22";
  src: url("https://github.com/okadus/roll20-penombre/blob/main/assets/fonts/P22Freely.otf")
    format("otf");
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: "Cattedrale";
  src: url("https://github.com/okadus/roll20-penombre/blob/main/assets/fonts/cattedrale-regular.otf")
    format("otf");
  font-weight: normal;
  font-style: normal;
}

/* === Variables === */
:root {
  --penombre-brown: #722f16;
  --penombre-red: #b85563;
  --penombre-gold: #8e7d36;
  --penombre-white: #fef4e8;
  --penombre-text: #2d221b;
  --penombre-light: #fcf1de;
  --penombre-dark: #f9e8ce;
  --penombre-gradient-dark-to-light: linear-gradient(
    to right,
    #f9e8ce 30%,
    #f1eae0 90%
  );
  --penombre-green: #5e7470;
  --penombre-font-freely: "P22Freely", "Fasthand", serif;
  --penombre-font-cattedrale: "Cattedrale", "Pirata One", serif;
}

.penombre-sheet {
  background-color: var(--penombre-brown);
  color: var(--penombre-text);
  border: 2px solid var(--penombre-brown);
  border-radius: 6px;
  padding: 0 10px 0;
  min-width: 833px;
}

/* === Bandeau === */
.header {
  background: linear-gradient(
      to left,
      #f8f2ea 30%,
      rgba(248, 242, 234, 0.1) 70%
    ),
    /* fondu beige → transparent */
      url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/banner.png?raw=true")
      left center / 70% 100% no-repeat;
  position: relative;
  min-height: 100px;
  margin-bottom: 10px;
}

.header .logo {
  width: 200px;
  height: auto;
  margin-bottom: 10px;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  right: 10px;
}

/* === Layout en colonnes === */
.columns {
  display: flex;
  gap: 12px;
  margin-top: 10px;
}
.col-left {
  flex: 0 0 40%;
}
.col-right {
  flex: 1;
}

/* === Identité === */
.section-identite {
  background: var(--penombre-white);
  padding: 8px;
  margin-bottom: 10px;
}

/* Conteneur horizontal : colonne verticale + zone d’inputs */
.identite-container,
.harmoniques-container,
.conscience-container {
  display: flex;
  align-items: stretch;
}

/* --- Titre vertical --- */
.titre-vertical {
  padding: 10px 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 2px;
}

.identite-titre {
  background: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/marron.webp?raw=true")
    center 60% / 50% no-repeat;
  color: var(--penombre-brown);
}

h3 {
  font-size: 1.8em;
}

h3.titre-vertical span {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg) translateX(16px);
  font-family: var(--penombre-font-cattedrale);
  text-align: center;
  font-weight: bold;
  letter-spacing: 2px;
}

/* --- Zone des champs --- */
.identite-champs {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  min-height: 250px;
}
.identite-champ {
  display: flex;
  align-items: flex-end;
  gap: 6px;
}

.identite-champ label {
  font-weight: bold;
  color: #6a3d1e;
  display: inline-block;
  margin: 0;
  width: 40px;
  font-size: 1.4rem;
}

.identite-champ input {
  border: none;
  border-bottom: 1px dotted #9d8a74;
  background: transparent;
  margin-bottom: 3px;
  width: calc(100% - 10px);
  display: inline-block;
  font-family: var(--penombre-font-freely);
  font-size: 1.5em;
  padding-bottom: 0;
}

/* === Harmoniques === */
.section-harmoniques {
  text-align: center;
  padding: 6px;
  background: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/fond-coupe.webp?raw=true")
    no-repeat 90% center;
  background-size: 70%;
  background-color: var(--penombre-white);
  margin-bottom: 10px;
}

.harmoniques-titre {
  background: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/grise.webp?raw=true")
    center 60% / 50% no-repeat;
  color: var(--penombre-green);
}

h3.harmoniques-titre span {
  margin-top: 45px;
}

/* grille générale */
.harmoniques-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  justify-items: center;
  width: 60%;
  margin-left: 10%;
}

/* Grille principale */
.harmoniques-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  justify-items: center;
}

/* Chaque bloc harmonique + label */
.harmonique-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.esprit-wrap {
  transform: translateX(30%);
}

.nature-wrap {
  transform: translateX(-35%);
}

.etincelle-wrap {
  transform: translateX(50%);
}

/* Visuel harmonique */
.harmonique {
  width: 100px;
  height: 100px;
  background-image: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/case_de_penombre.webp?raw=true");
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Sélecteur centré */
.harmonique select {
  border: none;
  background: transparent;
  font-weight: bold;
  font-size: 2rem;
  text-align: center;
  appearance: none;
  cursor: pointer;
  font-family: var(--penombre-font-freely);
  height: 60px;
  width: 60px;
  line-height: 60px;
  margin-left: 10px;
}

/* Label en dessous */
.harmonique-wrap .label-btn {
  font-family: var(--penombre-font-cattedrale);
  font-weight: 600;
  line-height: 1;
}

button.label-btn {
  background: var(--penombre-gradient-dark-to-light);
  border: 0;
  color: var(--penombre-green);
  padding: 0.8rem 0.5rem !important;
  font-size: 2em !important;
  cursor: pointer;

  &:hover {
    background: var(--penombre-brown);
    color: var(--penombre-light);
  }
}

button[type="roll"].label-btn::before {
  content: none !important;
}

.sub-label {
  display: block;
  text-transform: uppercase;
  font-size: 0.8rem;
  color: var(--penombre-red);
  font-weight: bold;
  margin-top: 2px;
}

/* ===== Conscience ===== */
.section-conscience {
  background: var(--penombre-white);
  padding: 8px;
}

.conscience-titre {
  background: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/doree.webp?raw=true")
    center 60% / 50% no-repeat;
  color: var(--penombre-gold);
}

h3.conscience-titre span {
  margin-top: 15px;
}

.conscience-header {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  margin-bottom: 6px;
}

.conscience-header h4 {
  font-family: var(--penombre-font-cattedrale);
  font-size: 2rem;
  color: var(--penombre-gold);
  margin-right: 10px;
}
.conscience-header input[type="number"] {
  width: 56px;
  text-align: center;
}

/* Jetons */
.tokens {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
  align-items: center;
  margin: 6px 0 10px;
}

.token {
  width: 46px;
  height: 46px;
  position: relative;
}
.token-btn {
  width: 46px;
  height: 46px;
  border: none;
  background: transparent;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  box-shadow: none;
}

.complications h4 {
  margin: 6px 0;
  font-size: 2.1rem;
  font-family: var(--penombre-font-cattedrale);
  color: var(--penombre-green);
  text-align: right;
}

/* États visuels */
input[name^="attr_token"][value="0"] + .token-btn {
  background-image: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/jeton_face_inactive.webp?raw=true");
}
input[name^="attr_token"][value="1"] + .token-btn {
  background-image: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/cercle.webp?raw=true");
}
input[name^="attr_token"][value="2"] + .token-btn {
  background-image: url("https://github.com/okadus/roll20-penombre/blob/main/assets/img/jeton_face_active.webp?raw=true");
}

/* === Masquage au-delà du cmax === */
input[name="attr_cmax"][value="0"] ~ .tokens .token:nth-child(n + 1) {
  display: none;
}
input[name="attr_cmax"][value="1"] ~ .tokens .token:nth-child(n + 2) {
  display: none;
}
input[name="attr_cmax"][value="2"] ~ .tokens .token:nth-child(n + 3) {
  display: none;
}
input[name="attr_cmax"][value="3"] ~ .tokens .token:nth-child(n + 4) {
  display: none;
}
input[name="attr_cmax"][value="4"] ~ .tokens .token:nth-child(n + 5) {
  display: none;
}
input[name="attr_cmax"][value="5"] ~ .tokens .token:nth-child(n + 6) {
  display: none;
}
input[name="attr_cmax"][value="6"] ~ .tokens .token:nth-child(n + 7) {
  display: none;
}
input[name="attr_cmax"][value="7"] ~ .tokens .token:nth-child(n + 8) {
  display: none;
}
input[name="attr_cmax"][value="8"] ~ .tokens .token:nth-child(n + 9) {
  display: none;
}
input[name="attr_cmax"][value="9"] ~ .tokens .token:nth-child(n + 10) {
  display: none;
}
input[name="attr_cmax"][value="10"] ~ .tokens .token:nth-child(n + 11) {
  display: none;
}
input[name="attr_cmax"][value="11"] ~ .tokens .token:nth-child(n + 12) {
  display: none;
}
input[name="attr_cmax"][value="12"] ~ .tokens .token:nth-child(n + 13) {
  display: none;
}
input[name="attr_cmax"][value="13"] ~ .tokens .token:nth-child(n + 14) {
  display: none;
}
input[name="attr_cmax"][value="14"] ~ .tokens .token:nth-child(n + 15) {
  display: none;
}
input[name="attr_cmax"][value="15"] ~ .tokens .token:nth-child(n + 16) {
  display: none;
}

/* Complications */
.complications h4 {
  margin: 6px 0;
}
.comp-row {
  display: grid;
  grid-template-columns: 1fr repeat(3, 24px);
  gap: 8px;
  align-items: center;
  margin-bottom: 6px;
}
.comp-row input[type="text"] {
  height: 30px;
  border: 1px solid #8e6245;
  background: #f3f0ed;
  padding: 0 8px;
}
.comp-row input[type="checkbox"] {
  width: 20px;
  height: 20px;
  accent-color: var(--penombre-brown);
  cursor: pointer;
}

.comp-help {
  font-style: italic;
  opacity: 0.8;
  margin: 4px 0 0;
}

/* ====== Section Pouvoirs ====== */
.pouvoirs,
.atouts,
.maitrise-magie {
  background: var(--penombre-white);
  padding: 10px;
  margin-bottom: 10px;
}

.pouvoirs h2,
.atouts h2 {
  font-family: var(--penombre-font-cattedrale);
  font-size: 2.8rem;
  color: var(--penombre-text);
  text-align: center;
}

/* Layout principal : flex */
.capacites-flex {
  display: flex;
  align-items: flex-start;
  gap: 16px;
}

/* ---- Colonne gauche : Potentiel ---- */
.col-potentiel {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 15%;
}

.potentiel-wrap {
  position: relative;
  width: 100%;
  height: 100%;
}

.potentiel-img {
  width: 80px;
  height: 80px;
  background: url("https://i.imgur.com/FsnUzgN.png") center/contain no-repeat;
}

input[type="number"].potentiel-input::-webkit-inner-spin-button,
input[type="number"].potentiel-input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"].potentiel-input {
  position: absolute;
  appearance: none;
  -moz-appearance: textfield;
  inset: 0;
  margin: 2.8rem auto;
  width: 48px;
  height: 48px;
  text-align: center;
  font-size: 2.5rem;
  font-weight: bold;
  border: none;
  background: transparent;
  color: var(--penombre-text);
  font-family: var(--penombre-font-freely);

  &:focus {
    outline: none;
  }
}

.potentiel-caption {
  font-weight: 700;
  color: var(--penombre-brown);
  font-family: var(--penombre-font-cattedrale);
  font-size: 2rem;
  margin: 0 0 0 1rem;
  transform: translateY(-10px);
}

/* ---- Colonne droite : Pouvoirs ---- */
.col-pouvoirs {
  flex: 1;
}

.pouvoirs-head {
  display: flex;
  justify-content: space-between;
  font-weight: 700;
  color: #4a372d;
  margin-bottom: 6px;
  padding-right: 6px;
}

.pouvoir-row {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  margin: 4px 0;
}

.pouvoir-row input[type="checkbox"] {
  width: 20px;
  height: 20px;
  accent-color: var(--penombre-brown);
  cursor: pointer;
  margin-top: 5px;
}

.pouvoir-row input[type="text"] {
  height: 32px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  width: 89px;
  font-family: var(--penombre-font-freely);
  font-size: 1.5rem;
  display: none;
}

.pouvoir-row textarea {
  flex: 2;
  height: 26px;
  margin-top: 5px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  font-family: var(--penombre-font-freely);
  font-size: 1.5rem;
  resize: none;
  overflow: hidden;
  line-height: 26px;
  transition: height 0.7s ease, border 0.7s ease;

  &:focus {
    outline: none;
    border: 1px dotted var(--penombre-brown);
    height: 140px;
  }
}

.pouvoir-row select[name="attr_pouvoir_type"] {
  height: 32px;
  width: 84px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  margin: 0;
  font-size: 1.5rem;
  cursor: pointer;
  font-family: var(--penombre-font-freely);
}

.pouvoir-row button.btn-roll {
  margin-top: 5px;
  height: 100%;
}

/* === Atouts === */

.col-atouts {
  flex: 1;
}

.atout-row {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  margin: 4px 0;
}

.atout-row input[type="text"] {
  flex: 2;
  height: 32px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  font-family: var(--penombre-font-freely);
  font-size: 1.5rem;
}

/* Conteneur niveaux */
.atout-level {
  display: inline-flex;
  gap: 6px;
  align-items: center;
}

/* Conteneur des niveaux */
.atout-level {
  display: inline-flex;
  align-items: center;
  position: relative;
}

/* Cases personnalisées */
.atout-row input[type="checkbox"] {
  width: 22px;
  height: 22px;
}

.case {
  width: 32px;
  height: 32px;
  background-image: url("https://i.imgur.com/IIe527s.png");
  background-size: cover;
  border: none;
  appearance: none;
  cursor: pointer;
}
.case:checked {
  background-image: url("https://i.imgur.com/2aG5NM1.png");
}

/* === Maîtrises Magiques === */
.col-magies {
  flex: 1;
}

.magie-row {
  display: flex;
  align-items: flex-start;
  /* flex-wrap: wrap; */
  gap: 8px;
  margin: 4px 0;
}

.magie-row textarea {
  flex: 2;
  height: 26px;
  margin-top: 5px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  font-family: var(--penombre-font-freely);
  font-size: 1.5rem;
  resize: none;
  overflow: hidden;
  line-height: 26px;
  transition: height 0.7s ease, border 0.7s ease;
  width: 120px;

  &:focus {
    outline: none;
    border: 1px dotted var(--penombre-brown);
    height: 140px;
  }
}

.magie-row select[name="attr_magie_harmonique"] {
  height: 32px;
  width: 75px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  margin: 0;
  font-size: 1.5rem;
  cursor: pointer;
  font-family: var(--penombre-font-freely);
}

.potentiel-img {
  height: 20px;
  width: 20px;
  background: url("https://i.imgur.com/FsnUzgN.png") center/contain no-repeat;
}

.magie-row input[type="number"] {
  height: 32px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  appearance: none;
  -moz-appearance: textfield;
  background: transparent;
  padding: 0 8px;
  font-size: 1.5rem;
  font-family: var(--penombre-font-freely);
  width: 20px;
}

.magie-row input[type="number"].magie-level-input::-webkit-inner-spin-button,
input[type="number"].magie-level-input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.magie-row input[type="text"] {
  height: 32px;
  border: none;
  border-bottom: 1px dotted var(--penombre-brown);
  background: transparent;
  padding: 0 8px;
  width: 110px;
  font-family: var(--penombre-font-freely);
  font-size: 1.5rem;
}

.magie-row button.btn-roll {
  margin-top: 5px;
  height: 100%;
}
